{% load request_is_management %}
{% load static %}

<h2>{{ proposal.title }}</h2>
<strong>Status:</strong> {{ proposal.proposal_status.name }} {{ link_to_edit_or_display|safe }}<br>
<strong>Call:</strong>
{% if request|request_is_management %}
    <a href="{% url 'logged-call-detail' pk=proposal.call.id %}">{{ proposal.call.long_name }}</a>
{% else %}
    {{ proposal.call.long_name }}
{% endif %}<br>
{% if external_url %}
    <strong>Link for applicant:</strong>
    <button id="external_url" class="unstyled-button"
            data-clipboard-text="{{ external_url }}"><i
            class="far fa-clipboard"></i></button>

    <script type="text/javascript" src="{% static 'external/clipboard/clipboard.min.js' %}"></script>
    <script>
        $('#external_url').tooltip({
            trigger: 'click',
            placement: 'bottom'
        });

        function setTooltip(message) {
            $('#external_url').tooltip('hide')
                .attr('data-original-title', message)
                .tooltip('show');
        }

        function hideTooltip() {
            setTimeout(function () {
                $('#external_url').tooltip('hide');
            }, 1000);
        }

        // Clipboard

        var clipboard = new ClipboardJS('#external_url');

        clipboard.on('success', function (e) {
            setTooltip('Copied!');
            hideTooltip();
        });

        clipboard.on('error', function (e) {
            setTooltip('Failed!');
            hideTooltip();
        });

    </script>
{% endif %}
<p></p>
